version: 2

metrics:
  - name: playback_count
    label: Playback Count

    calculation_method: count
    expression: '*'

    model: ref("f_playback")

    timestamp: playback_timestamp
    time_grains: [day, week, month, quarter, year]

    dimensions:
      - fk_artist
      - fk_album
      - fk_track

  - name: median_air_temperature
    label: Median Air Temperature

    calculation_method: median
    expression: air_temperature

    model: ref("f_playback")

    timestamp: playback_timestamp
    time_grains: [day, week, month, quarter, year]

    dimensions:
      - fk_artist
      - fk_album
      - fk_track

  - name: discovery_date
    label: Discovery Date

    calculation_method: min
    expression: "cast(playback_timestamp as date)"

    model: ref("f_playback")

    dimensions:
      - fk_artist
      - fk_album
      - fk_track
